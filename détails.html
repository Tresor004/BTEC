<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulaire d'achat de tickets</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <style>
        @media (max-width: 768px) {
            .ticket-image {
                width: 30px; /* Réduction de l'image dans le tableau */
            }
            .card-body img {
                width: 100%; /* Rendre les images flexibles */
                height: auto;
            }
            h4 {
                font-size: 18px; /* Réduction du titre */
            }
            .table-responsive {
                overflow-x: auto;
                display: block;
            }
            .btn {
                font-size: 14px;
                padding: 8px;
            }
            .nav-tabs .nav-link {
                font-size: 14px;
                padding: 5px;
            }
            .container {
                margin-top: 20px;
                margin-bottom: 20px;
            }
            .right-column {
                margin-left: 0;
                margin-top: 20px;
            }
            .card {
                margin-bottom: 20px;
            }
        }

        .card {
            border-radius: 0px;
            box-shadow: 0px 8px 20px rgba(0, 0, 0, 0.3);
        }

        .retour:hover {
            color: white;
        }
    </style>
</head>
<body style="background-color: rgba(105, 60, 252, 0.217);">
    <div style="display: flex; align-items: center;">
        <a href="etickets.html" style="color: black; text-decoration: none;">
            <h2 class="retour" style="margin-left: 20px; margin-top: 15px; display: inline-block;">
                <i class="bi bi-arrow-left-circle"></i>
            </h2>
        </a>
        <h4 style="display: inline-block; margin: 0; margin-left: 20px;">FESTIVAL DE L'IMAGINAIRE</h4>
    </div>

    <div class="container mt-5 mb-5">
        <div class="row">
            <!-- Colonne de gauche -->
            <div class="col-12 col-md-4">
                <!-- Div Visuel -->
                <div class="card">
                    <div class="card-header">
                        <h6 class="card-title">VISUEL</h6>
                    </div>
                    <div class="card-body d-flex justify-content-center align-items-center">
                        <img src="assets/images/welcome-hero/affiche.jpg" class="img-fluid" alt="Image de l'évènement" style="width: 250px; height: 250px;">
                    </div>
                </div>

                <!-- Div Détails -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6 class="card-title">DETAILS</h6>
                    </div>
                    <div class="card-body">
                        <h5 class="card-title"><strong>FESTIVAL DE L'IMAGINAIRE</strong></h5>
                        <p class="card-text"><i class="bi bi-calendar3"></i> 25 Octobre 2023, 18:00 au <br> 25 Octobre 2023, 22:00</p>
                        <p class="card-text"><i class="bi bi-geo-alt-fill"></i> Palais des congrès cadjèhoun</p>
                        <p class="card-text"><strong>COTONOU, BENIN</strong></p>
                    </div>
                </div>

                <!-- Div Partage -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6 class="card-title">PARTAGER</h6>
                    </div>
                    <div class="card-body text-center">
                        <div class="row mt-2">
                            <div class="col-6 d-grid">
                                <a href="#" class="btn btn-primary mb-2" target="_blank">
                                    <i class="bi bi-facebook"></i> Facebook
                                </a>
                                <a href="#" class="btn btn-info text-white" target="_blank">
                                    <i class="bi bi-twitter"></i> Twitter
                                </a>
                            </div>
                            <div class="col-6 d-grid">
                                <a href="#" class="btn btn-primary mb-2" style="background-color: #0077b5;" target="_blank">
                                    <i class="bi bi-linkedin"></i> LinkedIn
                                </a>
                                <a href="#" class="btn btn-danger" target="_blank">
                                    <i class="bi bi-instagram"></i> Instagram
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Colonne de droite -->
            <div class="col-12 col-md-8">
                <!-- Div Billetterie -->
                <div class="card">
                    <div class="card-header">
                        <h6 class="card-title">BILLETTERIE</h6>
                    </div>
                    <div class="card-body">
                        <ul class="nav nav-tabs" id="billetterieTabs" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" id="panier-tab" data-bs-toggle="tab" data-bs-target="#panier" type="button" role="tab" aria-controls="panier" aria-selected="true">Panier</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="coordonnees-tab" data-bs-toggle="tab" data-bs-target="#coordonnees" type="button" role="tab" aria-controls="coordonnees" aria-selected="false">Coordonnées</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="paiement-tab" data-bs-toggle="tab" data-bs-target="#paiement" type="button" role="tab" aria-controls="paiement" aria-selected="false">Paiement</button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" id="confirmation-tab" data-bs-toggle="tab" data-bs-target="#confirmation" type="button" role="tab" aria-controls="confirmation" aria-selected="false">Confirmation</button>
                            </li>
                        </ul>
                        <div class="tab-content" id="billetterieTabsContent">
                            <div class="tab-pane fade show active" id="panier" role="tabpanel" aria-labelledby="panier-tab">
                                <!-- Message d'instruction -->
                                <div class="alert alert-info text-center mt-3">
                                    Sélectionnez vos billets, identifiez-vous, payez et téléchargez vos billets.
                                </div>

                                <!-- Compte à rebours -->
                                <div class="text-center">
                                    <h6 style="color: red;">Temps restant : <span id="countdown">10:00</span></h6>
                                </div>
                                <div class="table-responsive">
                                    <table class="table table-bordered table-striped text-center mt-3">
                                        <thead class="thead-dark">
                                            <tr>
                                                <th scope="col">Tarifs</th>
                                                <th scope="col">Visuel</th>
                                                <th scope="col">Prix TTC</th>
                                                <th scope="col">Quantité</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>Pass simple</td>
                                                <td><img src="assets/images/welcome-hero/ticket.jpg" class="img-fluid ticket-image" alt="Pass simple"></td>
                                                <td>2000 Fcfa</td>
                                                <td><input type="number" class="form-control text-center quantity" data-price="2000" min="0" value="0"></td>
                                            </tr>
                                            <tr>
                                                <td>Pass soutien</td>
                                                <td><img src="assets/images/welcome-hero/ticket.jpg" class="img-fluid ticket-image" alt="Pass soutien"></td>
                                                <td>5000 Fcfa</td>
                                                <td><input type="number" class="form-control text-center quantity" data-price="5000" min="0" value="0"></td>
                                            </tr>
                                            <tr>
                                                <td>Pass VIP</td>
                                                <td><img src="assets/images/welcome-hero/ticket.jpg" class="img-fluid ticket-image" alt="Pass VIP"></td>
                                                <td>10000 Fcfa</td>
                                                <td><input type="number" class="form-control text-center quantity" data-price="10000" min="0" value="0"></td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
 
                                <style>
                                    @media (max-width: 576px) {
    .table-responsive {
        overflow-x: auto; /* Permet de scroller horizontalement si besoin */
        -webkit-overflow-scrolling: touch;
    }
    
    table {
        white-space: nowrap; /* Évite que les colonnes se cassent sur plusieurs lignes */
    }
    
    .table td, .table th {
        font-size: 14px; /* Réduit la taille du texte pour éviter les débordements */
    }
    
    .confirm-btn {
        padding: 5px 10px;
        font-size: 12px; /* Adapte la taille des boutons sur mobile */
    }
}

                                </style>
                                

                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <strong>Total :</strong> <span id="totalAmount">0 Fcfa</span>
                                    <div>
                                        <button class="btn btn-danger me-2" onclick="changerOnglet('panier')">Retour</button>
                                        <button class="btn btn-primary" onclick="changerOnglet('coordonnees')">Continuer</button>
                                    </div>
                                </div>
                            </div>

                            <div class="tab-pane fade" id="coordonnees" role="tabpanel" aria-labelledby="coordonnees-tab">
                                <form>
                                    <div class="form-group">
                                        <label for="nom">Nom</label>
                                        <input type="text" class="form-control" id="nom" placeholder="Entrez votre nom">
                                    </div><br>
                                    <div class="form-group">
                                        <label for="prenom">Prénom</label>
                                        <input type="text" class="form-control" id="prenom" placeholder="Entrez votre prénom">
                                    </div><br>
                                    <div class="form-group">
                                        <label for="email">Email</label>
                                        <input type="email" class="form-control" id="email" placeholder="Entrez votre email">
                                    </div><br>
                                    <div class="form-group">
                                        <label for="photo">Photo</label>
                                        <input type="file" class="form-control-file" id="photo" accept="image/*">
                                    </div> <br>
                                    <div class="form-group">
                                        <label for="moyenPaiement">Moyen de paiement</label>
                                        <select class="form-control" id="moyenPaiement" onchange="afficherChampTelephone()">
                                            <option value="">Sélectionnez un moyen de paiement</option>
                                            <option value="moov">Moov Money</option>
                                            <option value="mobile">Mobile Money</option>
                                            <option value="virement">Virement bancaire</option>
                                            <option value="carte">Carte bancaire</option>
                                        </select>
                                    </div>
                                    <div class="form-group" id="champTelephone" style="display: none;">
                                        <label for="telephone">Numéro de téléphone</label>
                                        <input type="tel" class="form-control" id="telephone" placeholder="Entrez votre numéro">
                                    </div>
                                </form><br>
                                <div class="d-flex justify-content-end">
                                    <button class="btn btn-danger me-2" onclick="changerOnglet('coordonnees')">Retour</button>
                                    <button class="btn btn-primary" onclick="changerOnglet('paiement')">Continuer</button>
                                </div>
                                
                            </div>
                            
                            <script>
                                function afficherChampTelephone() {
                                    let moyenPaiement = document.getElementById("moyenPaiement").value;
                                    let champTelephone = document.getElementById("champTelephone");
                            
                                    if (moyenPaiement === "moov" || moyenPaiement === "mobile") {
                                        champTelephone.style.display = "block";
                                    } else {
                                        champTelephone.style.display = "none";
                                    }
                                }
                            </script>
                            

                            <div class="tab-pane fade" id="paiement" role="tabpanel" aria-labelledby="paiement-tab">
                                <!-- Première partie : Coordonnées du client -->
                                <div class="p-3 border rounded mb-3">
                                    <h5>Coordonnées</h5>
                                    <p><strong>Nom :</strong> <span id="nom-resume"></span></p>
                                    <p><strong>Prénom :</strong> <span id="prenom-resume"></span></p>
                                    <p><strong>Email :</strong> <span id="email-resume"></span></p>
                                    <p><strong>Téléphone :</strong> <span id="telephone-resume"></span></p>
                                </div>
                            
                                <!-- Deuxième partie : Tableau des tickets achetés -->
                                <div class="p-3 border rounded mb-3">
                                    <h5>Résumé des tickets</h5>
                                    <table class="table table-bordered text-center">
                                        <thead class="thead-dark">
                                            <tr>
                                                <th>Tarif</th>
                                                <th>Prix Unitaire</th>
                                                <th>Quantité</th>
                                            </tr>
                                        </thead>
                                        <tbody id="ticket-resume">
                                            <!-- Les lignes seront ajoutées dynamiquement en JS -->
                                        </tbody>
                                    </table>
                                    <h5 class="text-end mt-3">Montant total : <span id="montant-total">0</span> Fcfa</h5>
                                </div>
                            
                                <!-- Bouton de validation -->
                                <div class="d-flex justify-content-end">
                                    <button class="btn btn-danger me-2" onclick="changerOnglet('paiement')">Retour</button>
                                    <button class="btn btn-primary" onclick="changerOnglet('confirmation')">Continuer</button>
                                </div>
                            </div>
                            
                            <script>
                                function mettreAJourResume() {
                                    // Récupération des informations du client
                                    document.getElementById("nom-resume").textContent = document.getElementById("nom").value;
                                    document.getElementById("prenom-resume").textContent = document.getElementById("prenom").value;
                                    document.getElementById("email-resume").textContent = document.getElementById("email").value;
                                    document.getElementById("telephone-resume").textContent = document.getElementById("telephone").value || "Non renseigné";
                            
                                    // Récupération des tickets achetés
                                    let lignesTickets = "";
                                    let total = 0;
                                    document.querySelectorAll(".quantity").forEach(input => {
                                        let quantite = parseInt(input.value, 10);
                                        let prix = parseInt(input.dataset.price, 10);
                                        let tarif = input.closest("tr").querySelector("td:first-child").textContent;
                            
                                        if (quantite > 0) {
                                            total += prix * quantite;
                                            lignesTickets += `
                                                <tr>
                                                    <td>${tarif}</td>
                                                    <td>${prix} Fcfa</td>
                                                    <td>${quantite}</td>
                                                </tr>
                                            `;
                                        }
                                    });
                            
                                    document.getElementById("ticket-resume").innerHTML = lignesTickets || "<tr><td colspan='3'>Aucun ticket sélectionné</td></tr>";
                                    document.getElementById("montant-total").textContent = total;
                                }
                            
                                // Appelle cette fonction au moment de passer à l'onglet "paiement"
                                document.getElementById("paiement-tab").addEventListener("click", mettreAJourResume);
                            </script>
                            
                            <div class="tab-pane fade text-center" id="confirmation" role="tabpanel" aria-labelledby="confirmation-tab">
                                <!-- Message de confirmation caché -->
                                <div id="confirmation-message" class="alert alert-success d-none">
                                    Paiement réussi ! Votre commande a été validée.
                                </div>
                            
                                <!-- Bouton centré -->
                                <div class="d-flex justify-content-center mt-4">
                                    <button type="button" class="btn btn-primary px-4 py-2" onclick="validerPaiement()">Valider le paiement</button>
                                </div>
                            </div>
                            
                            <!-- Fenêtre pop-up interne -->
                            <div id="popup" class="d-none">
                                <div class="popup-content">
                                    <h3>Paiement réussi !</h3>
                                    <p>Votre commande a été confirmée.</p>
                                    <button class="btn btn-light mt-2" onclick="fermerPopup()">OK</button>
                                </div>
                            </div>
                            
                            <!-- Styles pour la pop-up -->
                            <style>
                                #popup {
                                    position: fixed;
                                    top: 0;
                                    left: 0;
                                    width: 100%;
                                    height: 100%;
                                    background: rgba(0, 0, 0, 0.5);
                                    display: flex;
                                    justify-content: center;
                                    align-items: center;
                                }
                            
                                .popup-content {
                                    background: #28a745; /* Vert pour succès */
                                    color: white;
                                    padding: 20px;
                                    border-radius: 10px;
                                    text-align: center;
                                    box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.3);
                                }
                            </style>
                            
                            <!-- Script pour gérer la pop-up -->
                            <script>
                                function validerPaiement() {
                                    // Afficher la pop-up
                                    document.getElementById("popup").classList.remove("d-none");
                                }
                            
                                function fermerPopup() {
                                    // Fermer la pop-up
                                    document.getElementById("popup").classList.add("d-none");
                                }
                            </script>
                            
                        </div>
                    </div>
                </div>

                <!-- Div Description -->
                <div class="card mt-3">
                    <div class="card-header">
                        <h6 class="card-title mb-0">DESCRIPTION</h6>
                    </div>
                    <div class="card-body" style="text-align: justify;">
                        <p class="text-muted">
                            Rejoignez-nous pour une soirée magique avec des spectacles, des artistes et une immersion dans un univers fantastique !
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Compte à rebours de 10 minutes
        function startCountdown(duration) {
            let timer = duration, minutes, seconds;
            let countdownElement = document.getElementById('countdown');

            let interval = setInterval(function () {
                minutes = parseInt(timer / 60, 10);
                seconds = parseInt(timer % 60, 10);

                minutes = minutes < 10 ? "0" + minutes : minutes;
                seconds = seconds < 10 ? "0" + seconds : seconds;

                countdownElement.textContent = minutes + ":" + seconds;

                if (--timer < 0) {
                    clearInterval(interval);
                    countdownElement.textContent = "Temps écoulé";
                    alert("Votre session a expiré. Veuillez recommencer l'achat.");
                    window.location.reload(); // Recharge la page après expiration
                }
            }, 1000);
        }

        // Démarrer le compte à rebours dès l'affichage de la page
        document.addEventListener("DOMContentLoaded", function () {
            startCountdown(600); // 600 secondes = 10 minutes
        });

        // Fonction pour changer d'onglet
        function changerOnglet(ongletID) {
            let onglet = new bootstrap.Tab(document.getElementById(ongletID + "-tab"));
            onglet.show();
        }

        // Calcul du montant total
        const quantityInputs = document.querySelectorAll('.quantity');
        const totalAmount = document.getElementById('totalAmount');

        function updateTotal() {
            let total = 0;
            quantityInputs.forEach(input => {
                const quantity = parseInt(input.value);
                const price = parseInt(input.getAttribute('data-price'));
                total += quantity * price;
            });
            totalAmount.textContent = `${total} Fcfa`;
        }

        quantityInputs.forEach(input => {
            input.addEventListener('input', updateTotal);
        });

        // Validation du paiement
        function validerPaiement() {
            const success = Math.random() > 0.5; // Simule un succès ou un échec aléatoire
            const confirmationMessage = document.getElementById('confirmation-message');
            if (success) {
                confirmationMessage.classList.remove('d-none');
            } else {
                alert("Le paiement a échoué. Veuillez réessayer.");
            }
        }
    </script>
</body>
</html>